name: process-code-coverage-summary
description: GitHub Action that can create a status check or PR comment based on the provided results summary file.

inputs:
  github-token:
    description: "The GitHub token for interacting with the repository."
    required: true
  summary-file:
    description: "The summary file generated by the report-generator action."
    required: true
  report-name:
    description: "The desired name of the report that is shown on the PR Comment and inside the Status Check."
    required: true
    default: Code Coverage Results
  check-name:
    description: "The desired name of the status check."
    required: true
    default: code coverage
  create-status-check:
    description: "Flag indicating whether a status check with code coverage results should be generated."
    required: true
    default: "true"
  create-pr-comment:
    description: "Flag indicating whether a PR comment with code coverage results should be generated.  When `true` the default behavior is to update an existing comment if one exists."
    required: true
    default: "true"
  update-comment-if-one-exists:
    description: "When `create-pr-comment` is true, this flag determines whether a new comment is created or if the action updates an existing comment if one is found which is the default behavior."
    required: true
    default: "true"
  update-comment-key:
    description: |
      A simple alphanumeric string like *dotnet* or *jest* used to further identify the PR comment to update when this action is used more than once in a workflow.
      Only used when `update-comment-if-one-exists` is set to true.
      Each instance of the action should have a different key.
      This value should be static so it remains the same each time the workflow is run.
    required: false
  ignore-threshold-failures:
    description: "When set to true the check status is set to Neutral when the code coverage percentage is below the specified threshold and it will not block pull requests."
    required: false
    default: "false"
  line-threshold:
    description: "Threshold for line coverage.  The status check/comment will be marked as a failure if the actual line coverage amount is less than this.  Set to 0 if you do not want thresholds to be applied."
    required: false
    default: "0"
  branch-threshold:
    description: "Threshold for branch coverage.  The status check/comment will be marked as a failure if the actual branch coverage amount is less than this.  Set to 0 if you do not want thresholds to be applied."
    required: false
    default: "0"

outputs:
  coverage-outcome:
    description: "Coverage outcome based on Threshold comparisons: Failed|Passed.  If exceptions are thrown or if it exits early because of argument errors, this is set to Failed."

runs:
  using: "node20"
  main: "dist/index.js"
